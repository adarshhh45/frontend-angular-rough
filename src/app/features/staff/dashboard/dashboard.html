<div class="dashboard-container fade-in">
  <!-- Welcome Header -->
  <div class="welcome-section">
    <div class="welcome-content">
      <h1 class="welcome-title">
        Staff Dashboard
        <span class="wave">ðŸ‘‹</span>
      </h1>
      <p class="welcome-subtitle">Welcome! Here are your tools and statistics for today.</p>
    </div>
  </div>

  <!-- Quick Stats -->
  <div class="stats-grid">
    <mat-card class="stat-card tickets-card">
      <div class="stat-icon-wrapper tickets-icon">
        <mat-icon>qr_code_scanner</mat-icon>
      </div>
      <div class="stat-content">
        <p class="stat-label">Tickets Validated Today</p>
        <h2 class="stat-value">{{ ticketsValidatedToday }}</h2>
        <a mat-stroked-button color="primary" class="stat-action" routerLink="/staff/validate">
          <mat-icon>camera_alt</mat-icon>
          <span>Scan New Ticket</span>
        </a>
      </div>
    </mat-card>

    <mat-card class="stat-card transactions-card">
      <div class="stat-icon-wrapper transactions-icon">
        <mat-icon>how_to_reg</mat-icon>
      </div>
      <div class="stat-content">
        <p class="stat-label">Successful Scans</p>
        <h2 class="stat-value">{{ successfulScans }}</h2>
        <a mat-stroked-button color="primary" class="stat-action" routerLink="/staff/validate">
          <mat-icon>assessment</mat-icon>
          <span>Continue Validating</span>
        </a>
      </div>
    </mat-card>

    <mat-card class="stat-card wallet-card">
      <div class="stat-icon-wrapper wallet-icon">
        <mat-icon>gpp_bad</mat-icon>
      </div>
      <div class="stat-content">
        <p class="stat-label">Failed Scans</p>
        <h2 class="stat-value">{{ failedScans }}</h2>
         <button mat-stroked-button color="warn" class="stat-action" (click)="setFilter('failed')">
          <mat-icon>error_outline</mat-icon>
          <span>Review Issues</span>
        </button>
      </div>
    </mat-card>
  </div>

  <!-- Quick Actions -->
  <div class="section">
    <h2 class="section-title">
      <mat-icon>bolt</mat-icon>
      Quick Actions
    </h2>
    <div class="actions-grid-staff">
      <mat-card class="action-card primary-action" routerLink="/staff/validate">
        <div class="action-icon">
          <mat-icon>qr_code_scanner</mat-icon>
        </div>
        <div class="action-content">
          <h3>Validate Ticket</h3>
          <p>Scan a passenger's QR code</p>
        </div>
        <mat-icon class="action-arrow">arrow_forward</mat-icon>
      </mat-card>
    </div>
  </div>

  <!-- Recent Activity -->
  <div class="section" #recentValidationsSection>
    <div class="section-header">
      <h2 class="section-title">
        <mat-icon>timeline</mat-icon>
        Recent Validations
      </h2>
      <mat-button-toggle-group [(ngModel)]="currentFilter" (change)="setFilter($event.value)" class="filter-toggle">
        <mat-button-toggle value="all">All</mat-button-toggle>
        <mat-button-toggle value="successful">Successful</mat-button-toggle>
        <mat-button-toggle value="failed">Failed</mat-button-toggle>
      </mat-button-toggle-group>
    </div>
    
    <mat-card class="activity-card">
      <ng-container *ngIf="(filteredValidations$ | async) as validations">
        <div *ngIf="validations.length === 0" class="empty-state-small">
            <mat-icon>history_toggle_off</mat-icon>
            <p>No {{ currentFilter !== 'all' ? currentFilter : '' }} activity to display.</p>
        </div>
        
        <mat-list *ngIf="validations.length > 0">
          <mat-list-item *ngFor="let validation of validations" class="activity-list-item">
    <div matListItemIcon class="activity-icon" [ngClass]="{'successful': validation.valid, 'failed': !validation.valid}">
        <mat-icon>{{ validation.valid ? 'check_circle' : 'error' }}</mat-icon>
    </div>
    <div class="activity-content">
        <p class="activity-title">Ticket {{ validation.ticketNumber || 'N/A' }}</p>
        <p class="activity-message">{{ validation.message }}</p>
    </div>
    <div class="activity-meta">
        <span class="activity-status" [ngClass]="{'successful-text': validation.valid, 'failed-text': !validation.valid}">
            {{ validation.valid ? 'Success' : 'Failed' }}
        </span>
        <span class="activity-time">{{ validation.timestamp | date:'shortTime' }}</span>
    </div>
  </mat-list-item>
</mat-list>
      </ng-container>
    </mat-card>
  </div>
</div>